<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <title>字彙測驗</title>
  <style>
    body {
      font-family: 'Noto Sans TC', sans-serif;
      background: #f0f8ff;
      margin: 20px;
      color: #333;
    }
    h2 {
      text-align: center;
      color: #0066cc;
    }
    form {
      max-width: 800px;
      margin: auto;
      background: #fff;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    ol {
      padding-left: 20px;
    }
    li {
      margin-bottom: 25px;
      padding-top: 10px;
      border-bottom: 1px dashed #ddd;
    }
    label {
      display: inline-block;
      margin-right: 15px;
      cursor: pointer;
    }
    button {
      display: block;
      margin: 20px auto;
      padding: 10px 20px;
      background: #0066cc;
      color: #fff;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      cursor: pointer;
    }
    button:hover {
      background: #004c99;
    }
    /* 結果區塊樣式 */
    #result {
      text-align: center;
      margin-top: 20px;
      font-size: 18px;
      padding: 20px;
      border: 2px solid #E74C3C;
      border-radius: 8px;
      background-color: #FFFDEE;
      display: none; /* 初始隱藏 */
      max-width: 800px;
      margin-left: auto;
      margin-right: auto;
    }
    .result-list { 
      list-style-type: none; 
      padding-left: 0; 
    }
  </style>
</head>
<body>
<h2>TOEIC 核心字彙測驗 (15 題)</h2>
<form id="vocabQuiz">
  <ol>
    <li>The company plans to ____ a new marketing strategy next month.<br>
      <label><input type="radio" name="q1" value="0"> A. delay</label>
      <label><input type="radio" name="q1" value="1"> B. launch</label>
      <label><input type="radio" name="q1" value="2"> C. complain</label>
      <label><input type="radio" name="q1" value="3"> D. refuse</label>
    </li>
    <li>Please ____ the form and return it by Friday.<br>
      <label><input type="radio" name="q2" value="0"> A. expect</label>
      <label><input type="radio" name="q2" value="1"> B. avoid</label>
      <label><input type="radio" name="q2" value="2"> C. complete</label>
      <label><input type="radio" name="q2" value="3"> D. remind</label>
    </li>
    <li>The hotel offers free breakfast to all ____.<br>
      <label><input type="radio" name="q3" value="0"> A. managers</label>
      <label><input type="radio" name="q3" value="1"> B. employees</label>
      <label><input type="radio" name="q3" value="2"> C. guests</label>
      <label><input type="radio" name="q3" value="3"> D. partners</label>
    </li>
    <li>Sales have ____ significantly since the new product was released.<br>
      <label><input type="radio" name="q4" value="0"> A. protected</label>
      <label><input type="radio" name="q4" value="1"> B. avoided</label>
      <label><input type="radio" name="q4" value="2"> C. described</label>
      <label><input type="radio" name="q4" value="3"> D. increased</label>
    </li>
    <li>The meeting was ____ because several members were absent.<br>
      <label><input type="radio" name="q5" value="0"> A. postponed</label>
      <label><input type="radio" name="q5" value="1"> B. confused</label>
      <label><input type="radio" name="q5" value="2"> C. damaged</label>
      <label><input type="radio" name="q5" value="3"> D. promised</label>
    </li>
    <li>Employees are encouraged to share their ____ during the discussion.<br>
      <label><input type="radio" name="q6" value="0"> A. profits</label>
      <label><input type="radio" name="q6" value="1"> B. schedules</label>
      <label><input type="radio" name="q6" value="2"> C. salaries</label>
      <label><input type="radio" name="q6" value="3"> D. opinions</label>
    </li>
    <li>The office is located in a very ____ area with convenient transportation.<br>
      <label><input type="radio" name="q7" value="0"> A. usual</label>
      <label><input type="radio" name="q7" value="1"> B. simple</label>
      <label><input type="radio" name="q7" value="2"> C. private</label>
      <label><input type="radio" name="q7" value="3"> D. central</label>
    </li>
    <li>Please keep all customer information ____ and secure.<br>
      <label><input type="radio" name="q8" value="0"> A. available</label>
      <label><input type="radio" name="q8" value="1"> B. formal</label>
      <label><input type="radio" name="q8" value="2"> C. confidential</label>
      <label><input type="radio" name="q8" value="3"> D. temporary</label>
    </li>
    <li>The manager praised the team for their ____ work.<br>
      <label><input type="radio" name="q9" value="0"> A. nervous</label>
      <label><input type="radio" name="q9" value="1"> B. careless</label>
      <label><input type="radio" name="q9" value="2"> C. ordinary</label>
      <label><input type="radio" name="q9" value="3"> D. efficient</label>
    </li>
    <li>The company provides ____ training for new staff members.<br>
      <label><input type="radio" name="q10" value="0"> A. rare</label>
      <label><input type="radio" name="q10" value="1"> B. personal</label>
      <label><input type="radio" name="q10" value="2"> C. equal</label>
      <label><input type="radio" name="q10" value="3"> D. basic</label>
    </li>
    <li>The report contains ____ information about last year’s sales.<br>
      <label><input type="radio" name="q11" value="0"> A. silent</label>
      <label><input type="radio" name="q11" value="1"> B. flexible</label>
      <label><input type="radio" name="q11" value="2"> C. empty</label>
      <label><input type="radio" name="q11" value="3"> D. detailed</label>
    </li>
    <li>Customers can ____ the product online or in the store.<br>
      <label><input type="radio" name="q12" value="0"> A. imagine</label>
      <label><input type="radio" name="q12" value="1"> B. repair</label>
      <label><input type="radio" name="q12" value="2"> C. publish</label>
      <label><input type="radio" name="q12" value="3"> D. purchase</label>
    </li>
    <li>The airline announced a ____ in ticket prices.<br>
      <label><input type="radio" name="q13" value="0"> A. direction</label>
      <label><input type="radio" name="q13" value="1"> B. distance</label>
      <label><input type="radio" name="q13" value="2"> C. pressure</label>
      <label><input type="radio" name="q13" value="3"> D. increase</label>
    </li>
    <li>Please read the instructions ____ before using the machine.<br>
      <label><input type="radio" name="q14" value="0"> A. suddenly</label>
      <label><input type="radio" name="q14" value="1"> B. widely</label>
      <label><input type="radio" name="q14" value="2"> C. closely</label>
      <label><input type="radio" name="q14" value="3"> D. carefully</label>
    </li>
    <li>The new policy will ____ all departments in the company.<br>
      <label><input type="radio" name="q15" value="0"> A. prevent</label>
      <label><input type="radio" name="q15" value="1"> B. depend</label>
      <label><input type="radio" name="q15" value="2"> C. affect</label>
      <label><input type="radio" name="q15" value="3"> D. reduce</label>
    </li>
  </ol>
  <button type="button" onclick="checkAnswers()">提交答案</button>
</form>
<div id="result"></div>

<script>
  // 1. 詞彙選項陣列
  // 注意：此處的陣列順序必須與 HTML 中 A, B, C, D 的選項順序一致
  const options = [
    ["delay", "launch", "complain", "refuse"], // q1
    ["expect", "avoid", "complete", "remind"], // q2
    ["managers", "employees", "guests", "partners"], // q3
    ["protected", "avoided", "described", "increased"], // q4
    ["postponed", "confused", "damaged", "promised"], // q5
    ["profits", "schedules", "salaries", "opinions"], // q6
    ["usual", "simple", "private", "central"], // q7
    ["available", "formal", "confidential", "temporary"], // q8
    ["nervous", "careless", "ordinary", "efficient"], // q9
    ["rare", "personal", "equal", "basic"], // q10
    ["silent", "flexible", "empty", "detailed"], // q11
    ["imagine", "repair", "publish", "purchase"], // q12
    ["direction", "distance", "pressure", "increase"], // q13
    ["suddenly", "widely", "closely", "carefully"], // q14
    ["prevent", "depend", "affect", "reduce"] // q15
  ];

  // 2. 詞彙正確答案索引 (0=A, 1=B, 2=C, 3=D)
  // 根據 HTML 中的選項順序找到正確答案的索引
  const answers = [
    1, // q1: B. launch
    2, // q2: C. complete
    2, // q3: C. guests
    3, // q4: D. increased
    0, // q5: A. postponed
    3, // q6: D. opinions
    3, // q7: D. central
    2, // q8: C. confidential
    3, // q9: D. efficient
    3, // q10: D. basic
    3, // q11: D. detailed
    3, // q12: D. purchase
    3, // q13: D. increase
    3, // q14: D. carefully
    2 // q15: C. affect
  ];

  function checkAnswers() {
    const totalQuestions = answers.length;
    let score = 0;
    let unansweredCount = 0;
    let feedback = "<p>詞彙測驗結果：</p><ul style='text-align: left;' class='result-list'>";
    
    // 檢查未作答題目
    for (let i = 1; i <= totalQuestions; i++) {
      const selected = document.querySelector(`input[name="q${i}"]:checked`);
      if (!selected) {
        unansweredCount++;
      }
    }

    if (unansweredCount > 0) {
      alert(`⚠️ 詞彙測驗還有 ${unansweredCount} 題未作答，請完成所有題目後再提交！`);
      return; 
    }

    // 計算分數並產生結果
    for (let i = 1; i <= totalQuestions; i++) {
      const selected = document.querySelector(`input[name="q${i}"]:checked`);
      const questionIndex = i - 1;
      const correctIndex = answers[questionIndex];
      const correctAnswer = options[questionIndex][correctIndex];
      
      const selectedValue = parseInt(selected.value);
      const userChoiceText = options[questionIndex][selectedValue];
      
      let isCorrect = (selectedValue === correctIndex);
      
      if (isCorrect) {
        score++;
      }
      
      const color = isCorrect ? '#27AE60' : '#E74C3C'; // 綠色/紅色
      const resultText = isCorrect ? '✔ 正確' : '✘ 錯誤';

      feedback += `
        <li style="color:${color}; list-style: none; margin-bottom: 10px; border-bottom: 1px dashed #ccc; padding-bottom: 5px;">
          <strong>第 ${i} 題:</strong> ${resultText}<br>
          &nbsp; &nbsp; 您的答案: ${userChoiceText}<br>
          &nbsp; &nbsp; 正確答案: <span style='font-weight: bold; color: #27AE60;'>(${correctAnswer})</span>
        </li>
      `;
    }

    feedback += "</ul>";
    const finalScorePercentage = (score / totalQuestions) * 100;
    
    // 更新結果顯示
    const resultDiv = document.getElementById("result");
    resultDiv.style.display = 'block';
    resultDiv.innerHTML = 
      `<h3 style="color:#0066cc; border-bottom: 1px solid #0066cc; padding-bottom: 10px;">總分：${score} / ${totalQuestions} (${finalScorePercentage.toFixed(0)}%)</h3>` + feedback;
    
    resultDiv.scrollIntoView({ behavior: 'smooth' });
  }
</script>
</body>
</html>
