<script>
  // --- 詞彙測驗數據與邏輯 (q1 - q15) ---

  // 1. 詞彙選項陣列
  // 注意：此處的陣列順序必須與 HTML 中 A, B, C, D 的選項順序一致
  const options = [
    ["delay", "launch", "complain", "refuse"], // q1
    ["expect", "avoid", "complete", "remind"], // q2
    ["managers", "employees", "guests", "partners"], // q3
    ["protected", "avoided", "described", "increased"], // q4
    ["postponed", "confused", "damaged", "promised"], // q5
    ["profits", "schedules", "salaries", "opinions"], // q6
    ["usual", "simple", "private", "central"], // q7
    ["available", "formal", "confidential", "temporary"], // q8
    ["nervous", "careless", "ordinary", "efficient"], // q9
    ["rare", "personal", "equal", "basic"], // q10
    ["silent", "flexible", "empty", "detailed"], // q11
    ["imagine", "repair", "publish", "purchase"], // q12
    ["direction", "distance", "pressure", "increase"], // q13
    ["suddenly", "widely", "closely", "carefully"], // q14
    ["prevent", "depend", "affect", "reduce"] // q15
  ];

  // 2. 詞彙正確答案索引 (0=A, 1=B, 2=C, 3=D)
  // 根據 HTML 中的選項順序找到正確答案的索引
  const answers = [
    1, // q1: B. launch
    2, // q2: C. complete
    2, // q3: C. guests
    3, // q4: D. increased
    0, // q5: A. postponed
    3, // q6: D. opinions
    3, // q7: D. central
    2, // q8: C. confidential
    3, // q9: D. efficient
    3, // q10: D. basic
    3, // q11: D. detailed
    3, // q12: D. purchase
    3, // q13: D. increase
    3, // q14: D. carefully
    2 // q15: C. affect
  ];

  function checkAnswers() {
    const totalQuestions = answers.length;
    let score = 0;
    let unansweredCount = 0;
    let feedback = "<p>詞彙測驗結果：</p><ul style='text-align: left;' class='result-list'>";
    
    // 檢查未作答題目
    for (let i = 1; i <= totalQuestions; i++) {
      const selected = document.querySelector(`input[name="q${i}"]:checked`);
      if (!selected) {
        unansweredCount++;
      }
    }

    if (unansweredCount > 0) {
      alert(`⚠️ 詞彙測驗還有 ${unansweredCount} 題未作答，請完成所有題目後再提交！`);
      return; 
    }

    // 計算分數並產生結果
    for (let i = 1; i <= totalQuestions; i++) {
      const selected = document.querySelector(`input[name="q${i}"]:checked`);
      const questionIndex = i - 1;
      const correctIndex = answers[questionIndex];
      const correctAnswer = options[questionIndex][correctIndex];
      
      const selectedValue = parseInt(selected.value);
      const userChoiceText = options[questionIndex][selectedValue];
      
      let isCorrect = (selectedValue === correctIndex);
      
      if (isCorrect) {
        score++;
      }
      
      const color = isCorrect ? '#27AE60' : '#E74C3C'; // 綠色/紅色
      const resultText = isCorrect ? '✔ 正確' : '✘ 錯誤';

      feedback += `
        <li style="color:${color}; list-style: none; margin-bottom: 10px; border-bottom: 1px dashed #ccc; padding-bottom: 5px;">
          <strong>第 ${i} 題:</strong> ${resultText}<br>
          &nbsp; &nbsp; 您的答案: ${userChoiceText}<br>
          &nbsp; &nbsp; 正確答案: <span style='font-weight: bold; color: #27AE60;'>(${correctAnswer})</span>
        </li>
      `;
    }

    feedback += "</ul>";
    const finalScorePercentage = (score / totalQuestions) * 100;
    
    // 更新結果顯示
    const resultDiv = document.getElementById("result");
    resultDiv.style.display = 'block';
    resultDiv.style.padding = '20px';
    resultDiv.style.border = '2px solid #E74C3C';
    resultDiv.style.borderRadius = '8px';
    resultDiv.style.backgroundColor = '#FFFDEE';
    resultDiv.innerHTML = 
      `<h3 style="color:#0066cc; border-bottom: 1px solid #0066cc; padding-bottom: 10px;">總分：${score} / ${totalQuestions} (${finalScorePercentage.toFixed(0)}%)</h3>` + feedback;
    
    resultDiv.scrollIntoView({ behavior: 'smooth' });
  }
</script>
